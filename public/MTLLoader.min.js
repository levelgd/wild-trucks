THREE.MTLLoader=function(a){this.manager=void 0!==a?a:THREE.DefaultLoadingManager},THREE.MTLLoader.prototype={constructor:THREE.MTLLoader,load:function(a,t,e,r){var i=this,s=new THREE.XHRLoader(this.manager);s.load(a,function(a){t(i.parse(a))},e,r)},setBaseUrl:function(a){this.baseUrl=a},setMaterialOptions:function(a){this.materialOptions=a},parse:function(a){for(var t=a.split("\n"),e={},r=/\s+/,i={},s=0;s<t.length;s++){var o=t[s];if(o=o.trim(),0!==o.length&&"#"!==o.charAt(0)){var n=o.indexOf(" "),h=n>=0?o.substring(0,n):o;h=h.toLowerCase();var p=n>=0?o.substring(n+1):"";if(p=p.trim(),"newmtl"===h)e={name:p},i[p]=e;else if(e)if("ka"===h||"kd"===h||"ks"===h){var l=p.split(r,3);e[h]=[parseFloat(l[0]),parseFloat(l[1]),parseFloat(l[2])]}else e[h]=p}}var u=new THREE.MTLLoader.MaterialCreator(this.baseUrl,this.materialOptions);return u.setManager(this.manager),u.setMaterials(i),u}},THREE.MTLLoader.MaterialCreator=function(a,t){this.baseUrl=a,this.options=t,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.side=this.options&&this.options.side?this.options.side:THREE.FrontSide,this.wrap=this.options&&this.options.wrap?this.options.wrap:THREE.RepeatWrapping},THREE.MTLLoader.MaterialCreator.prototype={constructor:THREE.MTLLoader.MaterialCreator,setManager:function(a){this.manager=a},setMaterials:function(a){this.materialsInfo=this.convert(a),this.materials={},this.materialsArray=[],this.nameLookup={}},convert:function(a){if(!this.options)return a;var t={};for(var e in a){var r=a[e],i={};t[e]=i;for(var s in r){var o=!0,n=r[s],h=s.toLowerCase();switch(h){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(n=[n[0]/255,n[1]/255,n[2]/255]),this.options&&this.options.ignoreZeroRGBs&&0===n[0]&&0===n[1]&&0===n[1]&&(o=!1);break;case"d":this.options&&this.options.invertTransparency&&(n=1-n)}o&&(i[h]=n)}}return t},preload:function(){for(var a in this.materialsInfo)this.create(a)},getIndex:function(a){return this.nameLookup[a]},getAsArray:function(){var a=0;for(var t in this.materialsInfo)this.materialsArray[a]=this.create(t),this.nameLookup[t]=a,a++;return this.materialsArray},create:function(a){return void 0===this.materials[a]&&this.createMaterial_(a),this.materials[a]},createMaterial_:function(a){var t=this.materialsInfo[a],e={name:a,side:this.side};for(var r in t){var i=t[r];switch(r.toLowerCase()){case"kd":e.diffuse=(new THREE.Color).fromArray(i);break;case"ka":break;case"ks":e.specular=(new THREE.Color).fromArray(i);break;case"map_kd":e.map=this.loadTexture(this.baseUrl+i),e.map.wrapS=this.wrap,e.map.wrapT=this.wrap;break;case"ns":e.shininess=i;break;case"d":i<1&&(e.transparent=!0,e.opacity=i);break;case"map_bump":case"bump":if(e.bumpMap)break;e.bumpMap=this.loadTexture(this.baseUrl+i),e.bumpMap.wrapS=this.wrap,e.bumpMap.wrapT=this.wrap}}return e.diffuse&&(e.color=e.diffuse),this.materials[a]=new THREE.MeshLambertMaterial(e),this.materials[a]},loadTexture:function(a,t,e,r,i){var s,o=THREE.Loader.Handlers.get(a),n=void 0!==this.manager?this.manager:THREE.DefaultLoadingManager;return null!==o?s=o.load(a,e):(s=new THREE.Texture,o=new THREE.TextureLoader(n),o.load(a,function(a){s.image=THREE.MTLLoader.ensurePowerOfTwo_(a),s.needsUpdate=!0,e&&e(s)},r,i)),void 0!==t&&(s.mapping=t),s}},THREE.MTLLoader.ensurePowerOfTwo_=function(a){if(!THREE.Math.isPowerOfTwo(a.width)||!THREE.Math.isPowerOfTwo(a.height)){var t=document.createElement("canvas");t.width=THREE.MTLLoader.nextHighestPowerOfTwo_(a.width),t.height=THREE.MTLLoader.nextHighestPowerOfTwo_(a.height);var e=t.getContext("2d");return e.drawImage(a,0,0,a.width,a.height,0,0,t.width,t.height),t}return a},THREE.MTLLoader.nextHighestPowerOfTwo_=function(a){--a;for(var t=1;t<32;t<<=1)a|=a>>t;return a+1},THREE.EventDispatcher.prototype.apply(THREE.MTLLoader.prototype);